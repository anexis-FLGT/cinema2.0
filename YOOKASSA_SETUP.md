# Настройка интеграции с ЮKassa

## Шаг 1: Регистрация в ЮKassa

1. Перейдите по ссылке: https://yookassa.ru/joinups?createTestShop=true
2. Выберите "К тестированию платежей"
3. После регистрации вы получите доступ к тестовому магазину

## Шаг 2: Получение данных для интеграции

### ID магазина:
1. Войдите в личный кабинет ЮKassa
2. Перейдите в **Настройки → Магазин**
3. Скопируйте **ID магазина** (только цифры)

### Секретный ключ:
1. Перейдите в **Интеграция → Ключи API**
2. Скопируйте **Секретный ключ**

## Шаг 3: Настройка .env файла

Добавьте в файл `.env` следующие переменные:

```env
# ЮKassa настройки
YOOKASSA_SHOP_ID=ваш_id_магазина
YOOKASSA_SECRET_KEY=ваш_секретный_ключ
YOOKASSA_RETURN_URL=/payment/success
YOOKASSA_TEST_MODE=true

# Стоимость билета
TICKET_PRICE=500.00
```

## Шаг 4: Настройка Webhook (опционально)

1. В личном кабинете ЮKassa перейдите в **Настройки → HTTP-уведомления**
2. Добавьте URL: `https://ваш-домен.ru/payment/webhook`
3. Выберите события:
   - `payment.succeeded`
   - `payment.canceled`
   - `payment.waiting_for_capture`

## Тестовые карты для оплаты

### Успешная оплата:
- **Номер карты**: `5555 5555 5555 4444`
- **Срок действия**: любая будущая дата (например, `12/25`)
- **CVC**: любые 3 цифры (например, `123`)
- **Имя держателя**: любое имя

### Отклоненная оплата:
- **Номер карты**: `5555 5555 5555 4477`
- **Срок действия**: любая будущая дата
- **CVC**: любые 3 цифры

## Процесс оплаты

1. Пользователь выбирает места на странице бронирования
2. Видит стоимость и нажимает "Перейти к оплате"
3. Создается платеж в ЮKassa
4. Пользователь перенаправляется на страницу оплаты ЮKassa
5. После успешной оплаты пользователь возвращается на сайт
6. Бронирование подтверждается, места помечаются как забронированные

## Важно

- В тестовом режиме реальные деньги не списываются
- После создания платежа места резервируются со статусом `pending`
- При успешной оплате статус меняется на `succeeded` и места помечаются как забронированные
- При отмене платежа бронирования автоматически удаляются
- Для продакшена замените тестовые данные на реальные из личного кабинета ЮKassa

## Проверка работы

1. Выполните миграцию: `php artisan migrate`
2. Убедитесь, что в `.env` указаны правильные данные
3. Попробуйте создать бронирование и перейти к оплате
4. Используйте тестовую карту для оплаты
5. Проверьте статус платежа в личном кабинете ЮKassa





